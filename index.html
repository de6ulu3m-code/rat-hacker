<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>RatOS: Stock Trader</title>
    <style>
        body {
            background: #121212; color: #e0e0e0; font-family: 'Segoe UI', sans-serif;
            display: flex; flex-direction: column; align-items: center; padding: 20px;
        }
        .header { width: 100%; max-width: 600px; display: flex; justify-content: space-between; margin-bottom: 20px; }
        .balance { font-size: 24px; color: #ffcc00; font-weight: bold; }

        .market-card {
            background: #1e1e1e; border-radius: 12px; padding: 15px; width: 100%; max-width: 600px;
            margin-bottom: 15px; border: 1px solid #333; display: flex; align-items: center; justify-content: space-between;
        }
        .info { flex-grow: 1; }
        .price { font-size: 20px; font-family: monospace; }
        .up { color: #4caf50; } .down { color: #f44336; }

        .controls button {
            padding: 8px 15px; margin-left: 5px; border: none; border-radius: 5px;
            cursor: pointer; font-weight: bold; transition: 0.2s;
        }
        .buy { background: #4caf50; color: white; }
        .sell { background: #f44336; color: white; }
        .buy:hover, .sell:hover { opacity: 0.8; }

        #news-ticker {
            width: 100%; max-width: 600px; background: #000; color: #00ff41;
            padding: 10px; border-radius: 5px; margin-bottom: 20px; font-family: monospace;
            border: 1px solid #00ff41; overflow: hidden; white-space: nowrap;
        }

        .back-btn { margin-top: 30px; color: #888; text-decoration: none; border-bottom: 1px dashed #888; }
    </style>
</head>
<body>

<div class="header">
    <div class="balance">–¢–≤–æ–π –∫–∞–ø–∏—Ç–∞–ª: <span id="cheese-bal">0</span> üßÄ</div>
</div>

<div id="news-ticker">–û–ñ–ò–î–ê–ù–ò–ï –ù–û–í–û–°–¢–ï–ô –° –ü–û–ú–û–ô–ö–ò...</div>

<div id="market">
    </div>

<a href="https://de6ulu3m-code.github.io/ratpage/" class="back-btn">–í—ã–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä</a>

<script>
    let cheese = parseInt(localStorage.getItem('ratCheese')) || 0;
    
    // –î–∞–Ω–Ω—ã–µ —Ä—ã–Ω–∫–∞
    const stocks = [
        { id: 'cheddar', name: '–ß–µ–¥–¥–µ—Ä (–û–±—ã—á–Ω—ã–π)', price: 10, trend: 0, owned: 0 },
        { id: 'parmezan', name: '–ü–∞—Ä–º–µ–∑–∞–Ω (–≠–ª–∏—Ç–Ω—ã–π)', price: 50, trend: 0, owned: 0 },
        { id: 'product', name: '–°—ã—Ä–Ω—ã–π –ü—Ä–æ–¥—É–∫—Ç', price: 2, trend: 0, owned: 0 }
    ];

    const news = [
        { text: "–ú—ç—Ä –≥–æ—Ä–æ–¥–∞ —É—Ä–æ–Ω–∏–ª –≥–æ–ª–æ–≤–∫—É –ü–∞—Ä–º–µ–∑–∞–Ω–∞! –¶–µ–Ω–∞ —Ä–∞—Å—Ç–µ—Ç!", target: 'parmezan', impact: 1.5 },
        { text: "–ù–∞–π–¥–µ–Ω–∞ –±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è —Å–≤–∞–ª–∫–∞ –ß–µ–¥–¥–µ—Ä–∞. –†—ã–Ω–æ–∫ –≤ —à–æ–∫–µ!", target: 'cheddar', impact: 0.5 },
        { text: "–°—ã—Ä–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç –ø—Ä–∏–∑–Ω–∞–ª–∏ —Å—ä–µ–¥–æ–±–Ω—ã–º. –í–∑—Ä—ã–≤–Ω–æ–π —Ä–æ—Å—Ç!", target: 'product', impact: 3.0 },
        { text: "–ö–æ—Ç —Ä–∞–∑–æ–≥–Ω–∞–ª –≤—Å–µ—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤. –í—Å–µ —Ü–µ–Ω—ã –ø–∞–¥–∞—é—Ç!", target: 'all', impact: 0.8 }
    ];

    function updateUI() {
        document.getElementById('cheese-bal').innerText = cheese;
        localStorage.setItem('ratCheese', cheese);
        renderMarket();
    }

    function renderMarket() {
        const market = document.getElementById('market');
        market.innerHTML = '';
        stocks.forEach(s => {
            const card = document.createElement('div');
            card.className = 'market-card';
            card.innerHTML = `
                <div class="info">
                    <strong>${s.name}</strong><br>
                    <small>–í –ø–æ—Ä—Ç—Ñ–µ–ª–µ: ${s.owned}</small>
                </div>
                <div class="price ${s.trend >= 0 ? 'up' : 'down'}">
                    ${s.price.toFixed(2)} üßÄ ${s.trend >= 0 ? '‚ñ≤' : '‚ñº'}
                </div>
                <div class="controls">
                    <button class="buy" onclick="buy('${s.id}')">–ö–£–ü–ò–¢–¨</button>
                    <button class="sell" onclick="sell('${s.id}')">–ü–†–û–î–ê–¢–¨</button>
                </div>
            `;
            market.appendChild(card);
        });
    }

    function buy(id) {
        const s = stocks.find(x => x.id === id);
        if (cheese >= s.price) {
            cheese -= s.price;
            s.owned++;
            updateUI();
        }
    }

    function sell(id) {
        const s = stocks.find(x => x.id === id);
        if (s.owned > 0) {
            cheese += s.price;
            s.owned--;
            updateUI();
        }
    }

    // –°–∏–º—É–ª—è—Ü–∏—è —Ü–µ–Ω
    setInterval(() => {
        stocks.forEach(s => {
            let change = (Math.random() - 0.5) * (s.price * 0.1);
            s.trend = change;
            s.price = Math.max(0.5, s.price + change);
        });
        updateUI();
    }, 2000);

    // –°–ª—É—á–∞–π–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏
    setInterval(() => {
        const n = news[Math.floor(Math.random() * news.news.length)]; // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: news[idx]
        if (Math.random() > 0.7) {
            document.getElementById('news-ticker').innerText = n.text;
            if (n.target === 'all') {
                stocks.forEach(s => s.price *= n.impact);
            } else {
                const s = stocks.find(x => x.id === n.target);
                s.price *= n.impact;
            }
        }
    }, 8000);

    updateUI();
</script>
</body>
</html>
